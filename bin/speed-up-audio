#!/usr/bin/env bash

# Speeds up audio files

set -e

# Default speed increase
DEFAULT_SPEED=1.5

usage() {
    echo "Usage: $0 <filename> [speed]"
    echo "  <filename>: Path to the audio file to be sped up"
    echo "  [speed]: Optional speed increase factor (default is 1.5x)"
    exit 1
}

if [ $# -lt 1 ]; then
    usage
fi

FILENAME="$1"
[ -z "$FILENAME" ] && { echo "Usage: $0 <filename> [speed]"; exit 1; }

SPEED=${2:-$DEFAULT_SPEED}

OUTPUT_FILE="$(dirname $FILENAME)""/sped_$(basename $FILENAME)"

# Process the file with ffmpeg
ffmpeg -i "$FILENAME" -filter:a "atempo=$SPEED" -vn -map_metadata 0 -c:a libmp3lame "$OUTPUT_FILE"

echo "Processed file saved as: $OUTPUT_FILE"
